<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Garment Spec Report">
    <meta name="author" content="Matthew English">
    <title>Garment Spec Report Page</title>
    <!-- Bootstrap core CSS -->
    <link href="bootstrap-3.3.4-dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Custom styles for this template -->
    <link href="css/starter-template.css" rel="stylesheet">
    <link href="css/carousel.css" rel="stylesheet" />
    <link href="DataTables-1.10.7/media/css/jquery.dataTables_themeroller.css" rel="stylesheet" />

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery-1.11.2.min.js"></script>
    <script src="bootstrap-3.3.4-dist/js/bootstrap.min.js"></script>
    <script src="js/d3.v3.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>
    <script src="typeAhead/typeAheadBundle.js"></script>
    <!--DataTables-->
    <script src="DataTables-1.10.7/media/js/jquery.dataTables.js"></script>
    <script src="DataTables-1.10.7/extensions/ColVis/js/dataTables.colVis.js"></script>
    <script src="DataTables-1.10.7/extensions/TableTools/js/dataTables.tableTools.js"></script>
    <script src="DataTables-1.10.7/extensions/FixedHeader/js/dataTables.fixedHeader.js"></script>
    <script src="DataTables-1.10.7/extensions/Responsive/js/dataTables.responsive.js"></script>
    <link href="DataTables-1.10.7/extensions/FixedHeader/css/dataTables.fixedHeader.css" rel="stylesheet" />
    <link href="DataTables-1.10.7/extensions/Responsive/css/dataTables.responsive.css" rel="stylesheet" />
    <link href="DataTables-1.10.7/media/css/jquery.dataTables.css" rel="stylesheet" />
    <link href="DataTables-1.10.7/extensions/TableTools/css/dataTables.tableTools.css" rel="stylesheet" />
    <link href="DataTables-1.10.7/extensions/ColVis/css/dataTables.colVis.css" rel="stylesheet" />
    <link href="DataTables-1.10.7/Plugins/integration/bootstrap/3/dataTables.bootstrap.css" rel="stylesheet" />
    <script src="DataTables-1.10.7/Plugins/integration/bootstrap/3/dataTables.bootstrap.js"></script>
    <!--DataTables-->
    <link href="css/jquery.prompt.css" rel="stylesheet" />



    <!--PrettyLoader-->
    <link href="prettyLoader.css" rel="stylesheet" />
    <!--PrettyLoader-->
    <!--PrettyLoader-->


    <script src="js/jquery.browser.js"></script>
    <script src="js/jquery.prettyLoader.js"></script>
    <!--PrettyLoader-->
    <!--jsPdf-->
    <script src="jsPdf/jspdf.js"></script>
    <script src="jsPdf/jspdf.plugin.addhtml.js"></script>
    <script src="jsPdf/jspdf.plugin.autoprint.js"></script>
    <script src="jsPdf/libs/Deflate/adler32cs.js"></script>
    <script src="jsPdf/libs/Blob.js/BlobBuilder.js"></script>
    <script src="jsPdf/jspdf.plugin.addimage.js"></script>
    <script src="jsPdf/libs/png_support/zlib.js"></script>
    <script src="jsPdf/libs/png_support/png.js"></script>
    <script src="jsPdf/jspdf.plugin.png_support.js"></script>
    <script src="jsPdf/libs/FileSaver.js/FileSaver.js"></script>
    <script src="jsPdf/jspdf.plugin.standard_fonts_metrics.js"></script>
    <script src="jsPdf/jspdf.plugin.split_text_to_size.js"></script>
    <script src="jsPdf/jspdf.plugin.from_html.js"></script>
    <script src="jsPdf/examples/js/basic.js"></script>
    <script src="jsPdf/jspdf.plugin.javascript.js"></script>
    <script src="jsPdf/jspdf.plugin.png_support.js"></script>
    <script src="jsPdf/jspdf.plugin.sillysvgrenderer.js"></script>
    <script src="jsPdf/jspdf.PLUGINTEMPLATE.js"></script>


    <script src="js/jquery.prompt.js"></script>
    <script src="js/imagesloaded.pkgd.min.js"></script>
    <!--My Scripts begin here-->
    <script src="js/myReportGeneratorFunctions.js"></script>
    <script src="js/myProjectFunctionsV2Deferred.js"></script>
    <script src="js/nwJsFunctions.js"></script>
    <!--end construction of prototype of Garment Product Class-->

    <style>
        .page {
            page-break-after: always;
        }
    </style>
    <script>
        //begin code for type ahead in g prod form
        //use below for prd
        var url = location.href;
        var strUrlPrefix = 'http://wsflexwebprd1v.res.hbi.net/';
        //use below for dev
        //var strUrlPrefix = 'http://wsflexwebdev1v.res.hbi.net/';
        var strDevPefix = 'http://wsflexwebdev1v.res.hbi.net/';
        //var arrGarmentProductsArrayForTypeAhead = [];
        var arrSeasonNamesArray = [];
        var currentGarmentProduct = new garmentProduct();
        var strTypeBaseLink = strUrlPrefix + 'Windchill/servlet/TypeBasedIncludeServlet?oid=VR%3A';
        var strEncodeColonString = '%3A';
        var strU8 = '&u8=1';
        var strLinkBeginTag = '<a href="';
        var strLinkMidTag = '">';
        var strLinkCloseTag = '</a>';
        var gProdQueryURL = strUrlPrefix + 'Windchill/servlet/WindchillAuthGW/wt.enterprise.URLProcessor/invokeAction?oid=OR%3Awt.query.template.ReportTemplate%3A4711650&action=ProduceReport&u8=1'
        var returnArrays;
        var arrOfAttributeValueListIds = ['2381876', '102771', '2381693', '368058', '100575'];
        $('document').ready(function () {
            //document.getElementById('fileinput').addEventListener('change', readSingleFile, false);
            $.prettyLoader();
            var urlChecker = location.href;
            console.log(urlChecker);
            if (urlChecker.search('dontRunPrompt') == -1) {
                getLogin(arrOfAttributeValueListIds, currentGarmentProduct);
            };


            /*applyTypeAheadToElement(gProdQueryURL, '#gProd', 'Garment_Product_Name');
            currentGarmentProduct.getMyValueLists(arrOfAttributeValueListIds, currentGarmentProduct);*/
            $('#garmentProd').submit(function (e) {
                e.preventDefault();
                var nameToUse = $('#gProd').val();
                if (arrGarmentProductsArrayForTypeAhead.indexOf(nameToUse) != -1) {

                    $('#garmentFormContainer').fadeOut();
                    $('.clearThisComponentOnNewGarmentLoad *').remove();
                    $('#runNew,.clearThisComponentOnNewGarmentLoad,nav').fadeIn();
                    localStorage.setItem('lastGarmentRan', nameToUse);
                    currentGarmentProduct.getSpecByName(strUrlPrefix, nameToUse, currentGarmentProduct.thenCallSpecs, returnArrays, currentGarmentProduct);
                }
                else {
                    $('#gProd').val('');
                    $('#gProd').focus();
                    $('#garmentHeader').append('<p class="clearThisComponentOnNewGarmentLoad" id="noGarment">' + nameToUse + ' is not in the list of valid choices for a garment product.  Please use the typeahead to select a valid option.</p>')
                    $('#noGarment').delay(2500).fadeOut();
                }

            });
            $('#fileinput').on("change", function (e) {
                readSingleFile(e, currentGarmentProduct);
                $('#garmentFormContainer').fadeOut();
                $('#runNew,.clearThisComponentOnNewGarmentLoad').fadeIn();

            });
            //invoke prettyloader

            //invoke prettyloader
            makeMeSCrollSlow();
            checkStorageFor('lastGarmentRan', '#gProd');

            $('#loadLastGarmentProduct').click(function () {
                var strGarmentProdString = localStorage.getItem('garmentProductString');
                if (typeof (strGarmentProdString) != 'undefined') {
                    currentGarmentProduct = JSON.parse(strGarmentProdString);
                    //currentGarmentProduct.thenCallSpecs(returnArrays, currentGarmentProduct);
                    console.log(currentGarmentProduct);
                };

            });
            $('#fromSaved').click(function () {
                currentGarmentProduct.saveMe();

            });

            $('#garmentFormContainer,#runNew').hide();
            $('#usr').focus();
            if (typeof (localStorage.getItem('mattAppUser')) != 'undefined' && typeof (localStorage.getItem('mattAppPass')) != 'undefined') {
                $('#usr').val(localStorage.getItem('mattAppUser'));
                $('#pwd').val(localStorage.getItem('mattAppPass'));
            };
            //$('<div class="page"><div class="container"></div><p class=".col-md-4"></p><p class=".col-md-4">Nice isn\'t it!</p><p class=".col-md-4"></p></div>').confirm();
            $('#exportToCsv').click(function () {
                saveFile('#export_blocks', '#spreadReport');
            });
        });


        function readSingleFile(evt, objGarmentProduct) {
            //Retrieve the first (and only!) File from the FileList object
            var f = evt.target.files[0];

            if (f) {
                var r = new FileReader();
                r.onloadend = function (e) {
                    var contents = e.target.result;
                    var objFunctionObject;
                    objFunctionObject = JSON.parse(contents);
                    var keyNames = Object.keys(objFunctionObject);
                    for (var i = 0; i < keyNames.length; i++) {
                        var strPropName = keyNames[i];
                        var objPropValue = $(objFunctionObject).prop(strPropName);
                        $(objGarmentProduct).prop(strPropName, objPropValue);
                    };
                    console.log(objFunctionObject, objGarmentProduct);
                    objGarmentProduct.generateAvailableReportsList(objGarmentProduct);
                    //$('body').append(contents);
                    //console.log(currentGarmentProduct);
                    /*alert("Got the file.n"
                          + "name: " + f.name + "n"
                          + "type: " + f.type + "n"
                          + "size: " + f.size + " bytesn"
                          + "starts with: " + contents.substr(1, contents.indexOf("n"))
                    );*/
                }
                r.readAsText(f);
            } else {
                alert("Failed to load file");
            }
        };



    </script>

</head>
<body>
    <!----<button id="btnTestStuff">Use me to test things!</button>
    <input type="text" size="50" id="offline">
    <button id="loadLastGarmentProduct">Use me to load last Garment Prod!</button>-->

    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container" id="navTopDiv">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a id="topLeftNav" class="navbar-brand" href="#navTopDiv">Garment Spec Report Page</a>

            </div>
            <div id="navbar" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href='#tblRelationships'>Relationships</a></li>
                    <li><a href="javascript:makeMeScrollToDefinedTarget('#search',50,-100);">Reports</a></li>
                    <li><a href="javascript:makeMeScrollToDefinedTarget('#imagesDiv',50,-100);">Images</a></li>
                    <li><a href="javascript:createComponentTable('constructionDiv', 'construction', currentGarmentProduct.constructionTableString);makeMeScrollToDefinedTarget('#constructionDiv',50, -100);">Construction</a></li>
                    <li><a href="javascript:createComponentTable('measurementDiv', 'measurements', currentGarmentProduct.measurementTableString);makeMeScrollToDefinedTarget('#measurementDiv',50,-100);">Measurements</a></li>
                    <li><a href="javascript:makeMeScrollToDefinedTarget('#blockWeightSpreadDiv',50,-100);">Block Weights For Reference</a></li>
                    <li><a href="javascript:makeMeScrollToDefinedTarget('#labelsDiv',50,-100);">Label BOM</a></li>
                    <li><a href="javascript:makeMeScrollToDefinedTarget('#sewBomDiv',50,-100);">Sew & Sourced BOMs</a></li>
                    <li id="runNew"><a href='javascript:runNewProduct(currentGarmentProduct);'>Run a New Product</a></li>
                    <li><a href='javascript:currentGarmentProduct.saveMe(currentGarmentProduct);'>Save Garment</a></li>
                    <li><a href="javascript:pdfPage(currentGarmentProduct);">PDF</a></li>
                    <!-- <li><a href='javascript:pdfFromHtml("specs");'>PDF</a></li>
                        <li class="active"><a href="#">Top</a></li>
                    <li><a href="#about">Help</a></li>
                    <li><a href="#contact">Contact</a></li>-->
                </ul>
            </div>
        </div>
    </nav>
    </br></br></br></br></br>
    <div class="container-fluid" id="garmentFormContainer">
        <div class="col-md-10 starter-template row">
            <form id="garmentProd">


                <input class=".col-md-4" type="text" name="Product Name" size="50" id="gProd" placeholder="Enter Garment Product">
                <input class=".col-md-4" type="submit">
                <!--<input id="fileinput" type="file" class=".col-md-offset-4 .col-md-4 .col-md-offset-4 filestyle" data-classbutton="btn btn-primary" data-input="false" data-classicon="icon-plus" data-buttontext="Load Garment From File">-->

            </form>

        </div>

        <div class="col-md-2 starter-template row" style="padding:10px;font-weight:bolder; background-color:#446655;color: white;margin-top:10px;width:112px;overflow: hidden;">
            Load File From Garment<input id="fileinput" style="width:100px;color:#446655;display: inline;" type="file" />
        </div>

    </div>


    <div class="page">
        <div class="container-fluid clearThisComponentOnNewGarmentLoad" id="garmentHeader">

        </div>
    </div>
    <div class="page" >
        <div class="container-fluid clearThisComponentOnNewGarmentLoad" id="moaDiv">

        </div>
        <!-- container -->
    </div>
    <!-- /.container -->
    <div class="page" id="search">
        <div class="container-fluid clearThisComponentOnNewGarmentLoad" id="reportsHeader">

        </div>
        <!-- container -->
    </div>
    <div class="page">
        <div class="container-fluid clearThisComponentOnNewGarmentLoad" id="colorwaysListDiv">

        </div>
    </div>
    <div class="page">
        <div id="labelsDiv" class="container-fluid clearThisComponentOnNewGarmentLoad">

        </div>
        <!-- container -->
    </div>

    <div class="page">
        <div id="colorwaysDiv" class="container-fluid clearThisComponentOnNewGarmentLoad">

        </div>
        <!-- container -->
    </div>



    <div class="page">
        <div id="measurementDiv" class="container-fluid clearThisComponentOnNewGarmentLoad">

        </div>
        <!-- container -->
    </div>

    <div class="page">
        <div id="constructionDiv" class="container-fluid clearThisComponentOnNewGarmentLoad">

        </div>
        <!-- container -->
    </div>

    <div class="page">
        <div id="sewBomDiv" class="container-fluid clearThisComponentOnNewGarmentLoad">

        </div>
        <!-- container -->
    </div>

    <div class="page">
        <div id="sourceBomDiv" class="container-fluid clearThisComponentOnNewGarmentLoad">

        </div>
        <!-- container -->
    </div>

    <div class="page">
        <div id="blockWeightSpreadDiv" class="container-fluid clearThisComponentOnNewGarmentLoad">

        </div>
        <!-- container -->
    </div>

    <div class="page">
        <div id="blockWeightTrimDiv" class="container-fluid clearThisComponentOnNewGarmentLoad">

        </div>
        <!-- container -->
    </div>

    <div class="page">
        <div id="imagesDiv" class="container-fluid clearThisComponentOnNewGarmentLoad">

        </div>
    </div>
</body>
</html>
