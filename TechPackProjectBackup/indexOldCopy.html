<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Garment Spec Report">
    <meta name="author" content="Matthew English">
    <title>Garment Spec Report Page</title>
    <!-- Bootstrap core CSS -->
    <link href="bootstrap-3.3.4-dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Custom styles for this template -->
    <link href="css/starter-template.css" rel="stylesheet">
    <link href="css/carousel.css" rel="stylesheet" />
    <link href="DataTables-1.10.1/media/css/jquery.dataTables_themeroller.css" rel="stylesheet" />

</head>
<body>
    <button id="btnTestStuff">Use me to test things!</button>
    <p>test</p>
   
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a id="topLeftNav" class="navbar-brand" href="#">Garment Spec Report Page</a>

            </div>
            <div id="navbar" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href='#specBtns'>Specs</a></li>
                    <li><a href='#tblRelationships'>Relationships</a></li>
                    <li><a href='#components'>Components</a></li>
                    <li><a href='javascript:pdfFromHtml("specs");'>PDF</a></li>
                    <!--<li class="active"><a href="#">Top</a></li>
                    <li><a href="#about">Help</a></li>
                    <li><a href="#contact">Contact</a></li>-->
                </ul>
            </div>
        </div>
    </nav>
    <div class="container">
        <div class="starter-template">
            <form id="header" action="http://wsflexwebprd1v.res.hbi.net/Windchill/servlet/WindchillAuthGW/wt.enterprise.URLProcessor/URLTemplateAction">
                <input type="text" name="Product Name" size="50" id="gProd" placeholder="Enter Garment Product">
                <input type="hidden" name="oid" value="OR:wt.query.template.ReportTemplate:9663785" />
                <input type="hidden" name="action" value="ExecuteReport" />
                <input type="submit">
                <button id="btnClearGprod">Clear</button>
            </form>
        </div>
    </div>
    <!-- /.container -->
    <div class="page" id="search">
        <div class="container-fluid" id="garmentHeader">
            <!--<div class="row">
                  <article class="service col-md-4 col-sm-6 col-xs-12">
                    <h3></h3>
                    <p></p>
                </article> 
            </div>-->
        </div>
        <!-- container -->
    </div>

    <!--<div id="imagePages" class="page">
        <div id="myCarousel" class="carousel slide" data-ride="carousel">
            
            <ol class="carousel-indicators">
            </ol>
            <div class="carousel-inner" role="listbox">
                <div class="item active">

                    <div class="container">
                        <div class="carousel-caption">
                            <h1>Image pages</h1>
                            <p></p>

                        </div>
                    </div>
                </div>

            </div>
            <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
        
    </div>-->
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery-1.11.2.min.js"></script>
    <script src="bootstrap-3.3.4-dist/js/bootstrap.min.js"></script>
    <script src="js/d3.v3.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>
    <script src="typeAhead/typeAheadBundle.js"></script>
    <!--DataTables-->
    <script src="DataTables-1.10.1/media/js/jquery.dataTables.js"></script>
    <script src="DataTables-1.10.1/extensions/ColVis/js/dataTables.colVis.js"></script>
    <script src="DataTables-1.10.1/extensions/TableTools/js/dataTables.tableTools.js"></script>
    <script src="DataTables-1.10.1/extensions/FixedHeader/js/dataTables.fixedHeader.js"></script>
    <link href="DataTables-1.10.1/media/css/jquery.dataTables.css" rel="stylesheet" />
    <link href="DataTables-1.10.1/extensions/TableTools/css/dataTables.tableTools.css" rel="stylesheet" />
    <link href="DataTables-1.10.1/extensions/ColVis/css/dataTables.colVis.css" rel="stylesheet" />
    <link href="DataTables-1.10.1/extensions/FixedHeader/css/dataTables.fixedHeader.css" rel="stylesheet" />

    <!--DataTables-->

    <!--PrettyLoader-->
    <link href="prettyLoader.css" rel="stylesheet" />
    <!--PrettyLoader-->


    <!--PrettyLoader-->
    <script src="js/jquery.browser.js"></script>
    <script src="js/jquery.prettyLoader.js"></script>
    <!--PrettyLoader-->
    <!--jsPdf-->
    <script src="jsPdf/jspdf.js"></script>
    <script src="jsPdf/libs/Deflate/adler32cs.js"></script>
    <script src="jsPdf/libs/FileSaver.js/FileSaver.js"></script>
    <script src="jsPdf/libs/Blob.js/BlobBuilder.js"></script>
    <script src="jsPdf/jspdf.plugin.addimage.js"></script>
    <script src="jsPdf/libs/png_support/zlib.js"></script>
    <script src="jsPdf/libs/png_support/png.js"></script>
    <script src="jsPdf/jspdf.plugin.png_support.js"></script>
    <script src="jsPdf/jspdf.plugin.standard_fonts_metrics.js"></script>
    <script src="jsPdf/jspdf.plugin.split_text_to_size.js"></script>
    <script src="jsPdf/jspdf.plugin.from_html.js"></script>
    <script src="jsPdf/examples/js/basic.js"></script>
     <script>
         var objConstruction = {};
         $('document').ready(function () {
             /*var arrImgTestUrls = ['file://res.hbi.net/dfs/BrandedApparel/Activewear/FlexApp/Prod/00000000000e25', 'file://res.hbi.net/dfs/BrandedApparel/Activewear/FlexApp/Prod/00000000000a23'];
             Above URL is for testing when using a file protocl offline, switching below to dev http url
			 */


             var arrFill = [];
             $('#btnTestStuff').click(function () {
                 //    arrFill = getBase64StringsFromUrls(arrImgTestUrls);
                 //  console.log(arrFill);
                 //var doc = new jsPDF();
                 //doc.fromHTML(document.getElementById('tblRelationships'));
                 //doc.save('fromHtmlPdf');
                 objConstruction = getMyConstructionFromTask(strUrlPrefix, currentGarmentProduct.construction.branchId, currentGarmentProduct);
                 console.log(objConstruction);



             });
         });
    </script>
    <!--jsPdf-->
    <!--Instantiation of custom object for garment product and other custom scripts-->
    <!--<script src="js/garmentProductClass.js"></script> replaced this with more aptly named 'myfunctions.js'-->
    <script src="js/createjs-2015.05.21.min.js"></script>
    <script src="js/myPreloadJsFunctions.js"></script>
    <script src="js/myProjectFunctions.js"></script>
    <!--end construction of prototype of Garment Product Class-->

    <script id="garmentProdTypeAheadScript">
        //begin code for type ahead in g prod form
        //use below for prd
        /// <reference path="myProjectFunctionsV2Deffered.js" />
        var strUrlPrefix = 'http://wsflexwebprd1v.res.hbi.net/';
        //use below for dev
        //var strUrlPrefix = 'http://wsflexwebdev1v.res.hbi.net/';
        var strDevPefix = 'http://wsflexwebdev1v.res.hbi.net/';
        var arrGarmentProductsArrayForTypeAhead = [];
        var arrSeasonNamesArray = [];
        var currentGarmentProduct = new protGarmentProduct();
        var strTypeBaseLink = strUrlPrefix + 'Windchill/servlet/TypeBasedIncludeServlet?oid=VR%3A';
        var strEncodeColonString = '%3A';
        var strU8 = '&u8=1';
        var strLinkBeginTag = '<a href="';
        var strLinkMidTag = '">';
        var strLinkCloseTag = '</a>';

        $('document').ready(function () {
            //invoke prettyloader
            $.prettyLoader();
            //invoke prettyloader
            // Check for the various File API support.
            if (window.File && window.FileReader && window.FileList && window.Blob) {
                // Great success! All the File APIs are supported.

            } else {
                alert('The File APIs are not fully supported in this browser.');
            };

            $('a[href^="#"]').on('click', function (e) {
                e.preventDefault();

                var target = this.hash;
                var $target = $(target);

                $('html, body').stop().animate({
                    'scrollTop': $target.offset().top - 100
                }, 900, 'swing', function () {
                    window.location.hash = target;
                });
            });
            if (typeof (localStorage.getItem('lastGarmentRan')) == 'undefined') {
                //alert('nothing');
            }
            else {
                //alert(localStorage.getItem('lastGarmentRan'));
                $('#gProd').val(localStorage.getItem('lastGarmentRan'));
            };
            //navbar smooth scroll code



            $('#btnClearGprod').click(function () {
                localStorage.clear();
                $('#gProd').val('');
            });
            var gProdQueryURL = strUrlPrefix + 'Windchill/servlet/WindchillAuthGW/wt.enterprise.URLProcessor/invokeAction?oid=OR%3Awt.query.template.ReportTemplate%3A4711650&action=ProduceReport&u8=1'
            $.get(gProdQueryURL, function (data) {
                $('Garment_Product_Name', data).each(function () {
                    var gProdName = $(this).text();
                    gProdName = gProdName.substring(3, 1000);
                    arrGarmentProductsArrayForTypeAhead.push(gProdName);
                });
                //console.log(arrGarmentProductsArrayForTypeAhead);
            }).done(function () {
                $('#gProd').typeahead({
                    hint: true,
                    highlight: true,
                    minLength: 2
                },
                {
                    name: 'gProd',
                    displayKey: 'value',
                    source: substringMatcher(arrGarmentProductsArrayForTypeAhead)
                });
                $('#gProd').focus();
                //end code for typeahead, begin code for form processing
                $('form').submit(function (e) {
                    e.preventDefault();
                    $.ajax({
                        url: $(this).attr('action'),
                        type: 'get',
                        data: $(this).serialize(),
                        success: function (data) {
                            //read through anything come back 
                            var strReportRan = $('*', data).find('name').text();
                            //console.log(strReportRan);
                            switch (strReportRan) {
                                /*
                                this switch statement quickly grabs the report name from the response and 
                                then calls the appropriate function based upon the response and passes that function the data
                                from the ajax call.
                                */
                                case "Garment Prod to Garment Specs":
                                    processGarmentSpecs(data);
                                    break;

                            }
                        }
                    });
                });
            });
            //var seasonQueryUrl = strUrlPrefix + 'Windchill/servlet/WindchillAuthGW/wt.enterprise.URLProcessor/invokeAction?u8&action=ProduceReport&u8=1&oid=OR%3Awt.query.template.ReportTemplate%3A4715262&jrb=wt.query.template.reportTemplateRB&sortByIndex=1&sortOrder=asc'

            console.log(data)


        });
        var substringMatcher = function (strs) {
            return function findMatches(q, cb) {
                var matches, substringRegex;
                // an array that will be populated with substring matches
                matches = [];
                // regex used to determine if a string contains the substring `q`
                substrRegex = new RegExp(q, 'i');
                // iterate through the pool of strings and for any string that
                // contains the substring `q`, add it to the `matches` array
                $.each(strs, function (i, str) {
                    if (substrRegex.test(str)) {
                        // the typeahead jQuery plugin expects suggestions to a
                        // JavaScript object, refer to typeahead docs for more info
                        matches.push({ value: str });
                    }
                });
                cb(matches);
            };
        };

        
    </script>
</body>
</html>
